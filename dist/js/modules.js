!function(window,angular){"use strict";var ForgotPassword=["$scope","Loader","AccessData",function($scope,Loader,AccessData){var vm=this;vm.fields={},vm.send_success=!1,vm.send=function(){Loader.Settings.parent=document.querySelector('[type="submit"]'),Loader.Start(),AccessData.ForgotPassword(vm.fields).then(function(){vm.send_success=!0,Loader.End()},function(){vm.send_success=!1,Loader.End()})}}];angular.module("app").controller("ForgotPassword",ForgotPassword)}(window,window.angular),function(window,angular){"use strict";var Login=["$scope","$filter","$stateParams","Storage","CONFIG","Loader","UserSession","AccessData",function($scope,$filter,$stateParams,Storage,CONFIG,Loader,UserSession,AccessData){var vm=this;vm.fields={grant_type:"password"},vm.send=function(){Loader.Settings.parent=document.querySelector('[type="submit"]'),Loader.Start(),AccessData.Login($filter("obj_to_query_string")(vm.fields)).then(function(res){Loader.End();var obj={idUser:res.data.idUser,userName:res.data.userName,expires:res.data[".expires"],issued:res.data[".issued"],accessToken:res.data.access_token,tokenType:res.data.token_type};Storage.Set(CONFIG.session_ns+"Login",res.data),UserSession.Create(obj,"starting")},function(){Loader.End()})}}];angular.module("app").controller("Login",Login)}(window,window.angular),function(window,angular){"use strict";var Registration=["$scope","$filter","$stateParams","Storage","CONFIG","Loader","UserSession","AccessData",function($scope,$filter,$stateParams,Storage,CONFIG,Loader,UserSession,AccessData){var vm=this;vm.fields={},vm.send=function(){Loader.Settings.parent=document.querySelector('[type="submit"]'),Loader.Start(),AccessData.Registration(vm.fields).then(function(res){Loader.End();var obj={idUser:res.data.idUser,userName:res.data.userName,expires:res.data[".expires"],issued:res.data[".issued"],accessToken:res.data.access_token,tokenType:res.data.token_type};Storage.Set(CONFIG.session_ns+"Login",res.data),UserSession.Create(obj,"starting")},function(){Loader.End()})}}];angular.module("app").controller("Registration",Registration)}(window,window.angular),function(window,angular){"use strict";var AccessData=["$http","CONFIG",function($http,CONFIG){var _this=this,url={login:CONFIG.api+"Account/Login",recover_password:CONFIG.api+"Account/ForgotPassword",registration:CONFIG.api+"Account/Register"};return _this.Login=function(params){params=params?params:{};var request=$http({method:"post",url:url.login,data:params});return request},_this.ForgotPassword=function(params){params=params?params:{};var request=$http({method:"post",url:url.recover_password,data:params});return request},_this.Registration=function(params){params=params?params:{};var request=$http({method:"post",url:url.registration,data:params});return request},_this}];angular.module("app").factory("AccessData",AccessData)}(window,window.angular),function(window,angular){"use strict";var AccountHome=["$scope","$timeout","Storage","CONFIG","Loader","Broadcaster","AccountData",function($scope,$timeout,Storage,CONFIG,Loader,Broadcaster,AccountData){var vm=this;vm.company_infos=Storage.Get(CONFIG.session_ns+"CompanyInfos"),vm.update_company_info=function(obj){angular.extend(vm.company_infos,obj),Storage.Update(CONFIG.session_ns+"CompanyInfos",vm.company_infos),vm.company_infos.Logo=vm.company_infos.Logo.replace(/(_t=).{1,}/,"_t="+(new Date).getTime()),vm.company_infos.Cover=vm.company_infos.Cover.replace(/(_t=).{1,}/,"_t="+(new Date).getTime()),$timeout(function(){$scope.$apply()},100)},vm.fields_banner={OwnerName:vm.company_infos.Owner},vm.update_banner=function(e){e.preventDefault(),Loader.Settings.parent=document.querySelector('[name="frm_banner"] [type="submit"]'),Loader.Start(),AccountData.Banner(vm.fields_banner).then(function(){vm.update_company_info({Owner:vm.fields_banner.OwnerName})},function(){})["finally"](function(){Loader.End(),$scope.popover_banner.close()})},vm.fields_status={Status:vm.company_infos.Status},vm.update_status=function(e){e.preventDefault(),Loader.Settings.parent=document.querySelector('[name="frm_status"] [type="submit"]'),Loader.Start(),AccountData.Status(vm.fields_status).then(function(){vm.update_company_info({Status:vm.fields_status.Status})},function(){})["finally"](function(){Loader.End(),$scope.popover_status.close()})},vm.fields_product={},vm.product_frm_mode=!1,vm.product_edit_new=function(e,id,index){e.preventDefault(),id?(vm.product_frm_mode=!0,vm.fields_product=vm.company_infos.ProductPictures[index]):vm.fields_product={},vm.product_frm_mode=!0},vm.product_reset=function(e){e.preventDefault(),vm.product_frm_mode=!1},vm.product_send=function(e){e.preventDefault(),Loader.Settings.parent=document.querySelector('[name="frm_product"] [type="submit"]'),Loader.Start();var service="NewProduct",params=[{Picture:vm.fields_product.Picture,Caption:vm.fields_product.Caption}];vm.fields_product.Id&&(service="EditProduct",params=params[0],params.Id=vm.fields_product.Id),AccountData[service](params).then(function(res){if(!vm.fields_product.Id){var obj=[];angular.forEach(res.data,function(caption,id){"$id"!==id&&obj.push({Id:id,Caption:caption,Path:CONFIG.api+"Company/ProductPicture/"+id})}),vm.update_company_info({ProductPictures:obj})}vm.product_frm_mode=!1},function(){})["finally"](function(){Loader.End()})},vm.product_delete=function(e,id,index){e.preventDefault(),Loader.Settings.parent=e.target,Loader.Start(),AccountData.DeleteProduct(id).then(function(){vm.company_infos.ProductPictures.splice(index,1),vm.update_company_info({ProductPictures:vm.company_infos.ProductPictures})},function(){})["finally"](function(){Loader.End()})},vm.fields_profile={Profile:vm.company_infos.Profile},vm.update_profile=function(e){e.preventDefault(),Loader.Settings.parent=document.querySelector('[name="frm_profile"] [type="submit"]'),Loader.Start(),AccountData.Profile(vm.fields_profile).then(function(){vm.update_company_info({Profile:vm.fields_profile.Profile})},function(){})["finally"](function(){Loader.End(),$scope.popover_profile.close()})},vm.fields_services={Services:vm.company_infos.Services},vm.update_services=function(e){e.preventDefault(),Loader.Settings.parent=document.querySelector('[name="frm_services"] [type="submit"]'),Loader.Start(),vm.fields_services.Services=[vm.fields_services.Services],AccountData.Services(vm.fields_services).then(function(){vm.update_company_info({Services:vm.fields_profile.Services})},function(){})["finally"](function(){Loader.End(),$scope.popover_services.close()})},vm.fields_location={GeoLocation:vm.company_infos.GeoLocation.Geography.WellKnownText,Address:vm.company_infos.Address},vm.update_location=function(e){e.preventDefault(),Loader.Settings.parent=document.querySelector('[name="frm_location"] [type="submit"]'),Loader.Start(),AccountData.GeoLocation(vm.fields_location).then(function(){vm.update_company_info({GeoLocation:{Geography:{WellKnownText:vm.fields_location.GeoLocation}},Address:vm.fields_location.Address})},function(){})["finally"](function(){Loader.End(),$scope.popover_location.close()})},vm.fields_contact={Email:vm.company_infos.Email,Telephones:vm.company_infos.Telephones,Website:vm.company_infos.Website},vm.update_contact=function(e){e.preventDefault(),Loader.Settings.parent=document.querySelector('[name="frm_contact"] [type="submit"]'),Loader.Start(),vm.fields_contact.Telephones=[vm.fields_contact.Telephones],AccountData.Contact(vm.fields_contact).then(function(){vm.update_company_info({Email:vm.fields_contact.Email,Telephones:vm.fields_contact.Telephones,Website:vm.fields_contact.Website})},function(){})["finally"](function(){Loader.End(),$scope.popover_contact.close()})}}];angular.module("app").controller("AccountHome",AccountHome)}(window,window.angular),function(window,angular){"use strict";var AccountBanners=["$scope",function(){}];angular.module("app").controller("AccountBanners",AccountBanners)}(window,window.angular),function(window,angular){"use strict";var Abcd=["$scope",function(){}];angular.module("app").controller("Abcd",Abcd)}(window,window.angular),function(window,angular){"use strict";var Abcd=["$scope",function(){}];angular.module("app").controller("Abcd",Abcd)}(window,window.angular),function(window,angular){"use strict";var Abcd=["$scope",function(){}];angular.module("app").controller("Abcd",Abcd)}(window,window.angular),function(window,angular){"use strict";var Abcd=["$scope",function(){}];angular.module("app").controller("Abcd",Abcd)}(window,window.angular),function(window,angular){"use strict";var Abcd=["$scope",function(){}];angular.module("app").controller("Abcd",Abcd)}(window,window.angular),function(window,angular){"use strict";var Abcd=["$scope",function(){}];angular.module("app").controller("Abcd",Abcd)}(window,window.angular),function(window,angular){"use strict";var AccountData=["$http","CONFIG",function($http,CONFIG){var _this=this,url={infos:CONFIG.api+"Company/",cover:CONFIG.api+"Company/Cover/",logo:CONFIG.api+"Company/Logo/",get_product:CONFIG.api+"Company/ProductPicture/",banner:CONFIG.api+"Company/QuickSetup/Imagery",profile:CONFIG.api+"Company/QuickSetup/Profile",status:CONFIG.api+"Company/Status/Save",services:CONFIG.api+"Company/QuickSetup/Services",contact:CONFIG.api+"Company/QuickSetup/Contact",geo_location:CONFIG.api+"Company/QuickSetup/GeoLocation",new_product:CONFIG.api+"Company/ProductPicture/Add",edit_product:CONFIG.api+"Company/ProductPicture/Edit",product_delete:CONFIG.api+"Company/ProductPicture/Remove/"};return _this.Infos=function(params){params=params?params:{};var request=$http({method:"get",url:url.infos,params:params});return request},_this.Cover=function(params){params=params?params:{};var request=$http({method:"get",url:url.cover,params:params});return request},_this.Logo=function(params){params=params?params:{};var request=$http({method:"get",url:url.logo,params:params});return request},_this.GetProducts=function(params){params=params?params:{};var request=$http({method:"get",url:url.product,params:params});return request},_this.Banner=function(params){params=params?params:{};var request=$http({method:"post",url:url.banner,data:params});return request},_this.Profile=function(params){params=params?params:{};var request=$http({method:"post",url:url.profile,data:params});return request},_this.Status=function(params){params=params?params:{};var request=$http({method:"post",url:url.status,data:params});return request},_this.Services=function(params){params=params?params:{};var request=$http({method:"post",url:url.services,data:params});return request},_this.Contact=function(params){params=params?params:{};var request=$http({method:"post",url:url.contact,data:params});return request},_this.GeoLocation=function(params){params=params?params:{};var request=$http({method:"post",url:url.geo_location,data:params});return request},_this.GetProducts=function(params){params=params?params:{};var request=$http({method:"get",url:url.get_product,params:params});return request},_this.NewProduct=function(params){params=params?params:{};var request=$http({method:"post",url:url.new_product,data:params});return request},_this.EditProduct=function(params){params=params?params:{};var request=$http({method:"post",url:url.edit_product,data:params});return request},_this.DeleteProduct=function(id){var request=$http({method:"post",url:url.product_delete+id});return request},_this}];angular.module("app").factory("AccountData",AccountData)}(window,window.angular),function(window,angular){"use strict";var CategoriesData=["$http","CONFIG",function($http,CONFIG){var _this=this,url={get_categories:Services.Path+"Company/Category/All",post_categorie:CONFIG.api+"Company/Category/Add"};return _this.GetGategories=function(params){params=params?params:{};var request=$http({method:"get",url:url.get_categories,params:params});return request},_this.PostGategory=function(params){params=params?params:{};var request=$http({method:"post",url:url.post_categorie,data:params});return request},_this}];angular.module("app").factory("CategoriesData",CategoriesData)}(window,window.angular),function(window,angular){"use strict";var Error=["$scope","$stateParams","Storage","CONFIG",function($scope,$stateParams,Storage,CONFIG){var vm=this;switch(vm.status=$stateParams.status?parseInt($stateParams.status):404,vm.last_section=Storage.Get(CONFIG.session_ns+"History").reverse()[1],vm.error_message="",vm.status){case 400:vm.error_message="400! Bad Request.";break;case 401:vm.error_message="401! Unathorize to access this page.";break;case 403:vm.error_message="403! Forbidden.";break;case 404:vm.error_message="404! Page not found.";break;case 405:vm.error_message="405! Method not alowed.";break;case 408:vm.error_message="408! Request timeout.";break;case 414:vm.error_message="414! Request to looooong...";break;case 500:vm.error_message="500! Internal server error.";break;case 502:vm.error_message="502! Bad Gateway.";break;case 502:vm.error_message="502! Service unavailable.";break;case 505:vm.error_message="505! HTTP version is not supported.";break;case"expired":vm.error_message="Session expired."}}];angular.module("app").controller("Error",Error)}(window,window.angular),function(window,angular){"use strict";var GeneralData=["$http","CONFIG",function($http,CONFIG){var _this=this,url={get_company_all:CONFIG.api+"Company/All",get_country_city:CONFIG.api+"Geo/All",get_userinfo:CONFIG.api+"Account/UserInfo",get_company_categories:CONFIG.api+"Company/Category/All",get_companyinfo:CONFIG.api+"Company/",get_offer_types:CONFIG.api+"Offer/Types/All"};return _this.CompanyAll=function(){var request=$http({method:"get",url:url.get_company_all});return request},_this.CountryCity=function(){var request=$http({method:"get",url:url.get_country_city});return request},_this.UserInfo=function(params){params=params?params:{};var request=$http({method:"get",url:url.get_userinfo,params:params});return request},_this.CompanyCategories=function(params){params=params?params:{};var request=$http({method:"get",url:url.get_company_categories,params:params});return request},_this.CompanyInfo=function(company_id){var request=$http({method:"get",url:url.get_companyinfo+company_id});return request},_this.OfferTypes=function(params){params=params?params:{};var request=$http({method:"get",url:url.get_offer_types,params:params});return request},_this}];angular.module("app").factory("GeneralData",GeneralData)}(window,window.angular),function(window,angular){"use strict";var HighlightsDetail=["$scope","Storage","CONFIG",function($scope,Storage,CONFIG){var vm=this;vm.detail=Storage.Get(CONFIG.session_ns+"Highlight")}];angular.module("app").controller("HighlightsDetail",HighlightsDetail)}(window,window.angular),function(window,angular){"use strict";var HighlightsHome=["$scope","$timeout","$location","Storage","CONFIG","Loader","HighlightData",function($scope,$timeout,$location,Storage,CONFIG,Loader,HighlightData){var vm=this;vm.list=[],vm.ready=!1,vm.stage=function(arr){var obj=[];return angular.forEach(arr,function(item){item.PicturePath=CONFIG.api+"Highlight/Picture/"+item.Id,obj.push(item)}),obj},HighlightData.GetHighlights().then(function(res){vm.list=vm.stage(res.data),$timeout(function(){var swipe_el=document.querySelector(".swipe"),swipe_li=angular.element(document.querySelectorAll(".swipe-bullets li")),swipe_param={continuous:!0,callback:function(index){swipe_li.removeClass("selected").eq(index).addClass("selected")}};window.mySwipe=new Swipe(swipe_el,swipe_param)},300)})["finally"](function(){vm.ready=!0}),vm.cache=function(e,index,id){e.preventDefault();var name=CONFIG.session_ns+"Highlight",method=Storage.Get(name)?"Update":"Set";Storage[method](name,vm.list[index]),$location.path("/highlights/"+id)}}];angular.module("app").controller("HighlightsHome",HighlightsHome)}(window,window.angular),function(window,angular){"use strict";var HighlightData=["$http","CONFIG",function($http,CONFIG){var _this=this,url={get_highlights:CONFIG.api+"Highlight/All",get_highlight:CONFIG.api+"Highlight/",post_highlight:CONFIG.api+"Highlight/Save"};return _this.GetHighlights=function(params){params=params?params:{};var request=$http({method:"get",url:url.get_highlights,params:params});return request},_this.GetHighlight=function(params){params=params?params:{};var request=$http({method:"get",url:url.get_highlight,params:params});return request},_this.PostHighlight=function(params){params=params?params:{};var request=$http({method:"post",url:url.post_highlight,data:params});return request},_this}];angular.module("app").factory("HighlightData",HighlightData)}(window,window.angular),function(window,angular){"use strict";var MessagesList=["$scope","$timeout","$location","Storage","CONFIG","Loader","MessageData",function($scope,$timeout,$location,Storage,CONFIG,Loader,MessageData){var vm=this;vm.list=[],vm.list_sent=null,vm.list_sent_new=0,vm.list_in=null,vm.list_in_new=0,vm.ready=!1,vm.fetch=function(){vm.list.length||vm.ready||(Loader.Settings.className="spinney-content",Loader.Settings.parent=document.querySelector(".content__inner"),Loader.Start()),MessageData.Get().then(function(res){vm.list=res.data;var temp_sent=[],temp_sent_new=0,temp_in=[],temp_in_new=0;angular.forEach(res.data,function(item){"Sent"===item.Inbox?(temp_sent.push(item),console.log("Sent: ",item.MessageState),0===item.MessageState&&temp_sent_new++):(temp_in.push(item),console.log("In: ",item.MessageState),0===item.MessageState&&temp_in_new++)}),vm.list_sent=temp_sent,vm.list_sent_new=temp_sent_new,vm.list_in=temp_in,vm.list_in_new=temp_in_new,console.log("vm.list_in: ",vm.list_in),console.log("vm.list_sent: ",vm.list_sent)},function(){})["finally"](function(){vm.ready||(vm.ready=!0,Loader.End())})},vm.fetch();var lock=!1;vm.cache=function(e,index,collection,id){if(e.preventDefault(),lock)return!1;console.log("Cache");var temp=angular.copy(vm[collection][index]),name=CONFIG.session_ns+"Message",method=Storage.Get(name)?"Update":"Set";Storage[method](name,temp),$location.path("/messages/tread/"+id)},vm.set_options_event=function(){var el=angular.element(document.querySelectorAll(".ui-list__item--msg")),interval=null;el.bind("touchstart",function(e){console.log("Start"),interval=window.setInterval(function(){e.preventDefault(),window.clearInterval(interval),lock=!0},1500)}).bind("touchend",function(){console.log("End"),$timeout(function(){lock=!1},300),window.clearInterval(interval)})}}];angular.module("app").controller("MessagesList",MessagesList)}(window,window.angular),function(window,angular){"use strict";var MessageNew=["$scope","$timeout","Loader","MessageData",function($scope,$timeout,Loader,MessageData){var vm=this;vm.fields={},vm.success=!1,vm.fail=!1,vm.send=function(){Loader.Settings.parent=document.querySelector('[name="frm_msg_new"] [type="submit"]'),Loader.Start(),MessageData.Send(vm.fields).then(function(){vm.success=!0,$timeout(function(){$scope.popover_msg.close()},2e3)})["finally"](function(){Loader.End()})}}];angular.module("app").controller("MessageNew",MessageNew)}(window,window.angular),function(window,angular){"use strict";var MessagesTread=["$scope","Loader","Storage","CONFIG","MessageData",function($scope,Loader,Storage,CONFIG,MessageData){var vm=this,temp_tread=Storage.Get(CONFIG.session_ns+"Message"),company_infos=Storage.Get(CONFIG.session_ns+"CompanyInfos");MessageData.SetState({State:1,Messages:[temp_tread.Id]}),temp_tread.Replies.unshift({FromCompany:temp_tread.FromCompany,Message:temp_tread.Message,RegistrationDate:temp_tread.RegistrationDate}),vm.stage=function(arr){var now=(new Date).getTime(),min=6e4,hour=36e5,day=864e5,week=6048e5;return angular.forEach(arr,function(item){var diff=now-new Date(item.RegistrationDate).getTime(),time_ago="";time_ago=min>diff?parseInt(diff/1e3)+" seconds ago":diff>=min&&hour>diff?parseInt(diff/min)+" minutes ago":diff>=hour&&day>diff?parseInt(diff/hour)+" hours ago":diff>=day&&week>diff?parseInt(diff/day)+" days ago":parseInt(diff/week)+" weeks ago",item.TimeAgo=time_ago,item.Logo=CONFIG.api+"Company/Logo/"+item.FromCompany.Id+"?_t="+now,item.MyReply=company_infos.Id===item.FromCompany.Id}),arr},temp_tread.Replies=vm.stage(temp_tread.Replies),vm.tread=temp_tread,vm.reply=function(){Loader.Settings.parent=document.querySelector('[name="frm_msg_reply"] [type="submit"]'),Loader.Settings.className="reply",Loader.Start();var param={ReplyFromMessageID:temp_tread.Id,Message:vm.fields.Message};MessageData.Reply(param).then(function(res){var temp_reply=vm.stage([{Id:res.data,FromCompany:company_infos,Message:vm.fields.Message,RegistrationDate:new Date}]);vm.tread.Replies.push(temp_reply[0])},function(){})["finally"](function(){Loader.End(),vm.fields.Message=""})}}];angular.module("app").controller("MessagesTread",MessagesTread)}(window,window.angular),function(window,angular){"use strict";var MessageData=["$http","CONFIG",function($http,CONFIG){var _this=this,url={get:CONFIG.api+"Offer/Message/Received/Inbox",send:CONFIG.api+"Offer/Message/Send",reply:CONFIG.api+"Offer/Message/Reply",set_state:CONFIG.api+"Offer/Message/SetState",set_inbox:CONFIG.api+"Offer/Message/SetInbox"};return _this.Get=function(odata){var request=$http({method:"get",url:url.get+(odata?"?"+odata:"")});return request},_this.Send=function(params){params=params?params:{};var request=$http({method:"post",url:url.send,data:params});return request},_this.Reply=function(params){params=params?params:{};var request=$http({method:"post",url:url.reply,data:params});return request},_this.SetState=function(params){params=params?params:{};var request=$http({method:"post",url:url.set_state,data:params});return request},_this.SetInbox=function(params){params=params?params:{};var request=$http({method:"post",url:url.set_inbox,data:params});return request},_this}];angular.module("app").factory("MessageData",MessageData)}(window,window.angular),function(window,angular){"use strict";var Nav=["$scope","Storage","CONFIG","Broadcaster",function($scope,Storage,CONFIG,Broadcaster){var vm=this;vm.user_info=Storage.Get(CONFIG.session_ns+"UserInfos");var update=function(data){vm.user_info=data,vm.user_info.Logo=CONFIG.api+"Company/Logo/"+data.Company.Id+"?_t="+(new Date).getTime()};null!==vm.user_info&&update(vm.user_info),Broadcaster.Set("broadcast_nav"),$scope.$on("broadcast_nav",function(event,data){update(data)})}];angular.module("app").controller("Nav",Nav)}(window,window.angular),function(window,angular){"use strict";var NavData=["$http","CONFIG",function($http){var _this=this,url={nav:Services.Path+"Nav/Counter"};return _this.Counter=function(params){params=params?params:{};var request=$http({method:"get",url:url.login,params:params});return request},_this}];angular.module("app").factory("NavData",NavData)}(window,window.angular),function(window,angular){"use strict";var Network=["$scope","Loader","Storage","CONFIG","NetworkData",function($scope,Loader,Storage,CONFIG,NetworkData){var vm=this;vm.per_page=5,vm.offset=0,vm.loading_infinity=!1,vm.finish_infinity=!1,vm.loading_pull=!1,vm.ready=!0,vm.categories=Storage.Get(CONFIG.session_ns+"Categories"),vm.list=[],vm.stage=function(arr){return angular.forEach(arr,function(item){if(item.Thumb=CONFIG.api+"Company/Logo/"+item.Id+"?_t="+(new Date).getTime(),item.Categories.length)for(var x in vm.categories)if(vm.categories[x].Id===item.Categories[0].Id){item.CategoryName=vm.categories[x].Name;break}}),arr},vm.fetch=function(){vm.loading_infinity&&vm.offset++;var param=null;param=vm.loading_pull?"&$orderby=Name desc&$top="+vm.per_page+"&$skip=0":"&$orderby=Name desc&$top="+vm.per_page+"&$skip="+vm.offset*vm.per_page;var OData=param;!vm.list.length&&vm.ready&&(Loader.Settings.className="spinney-content",Loader.Settings.parent=document.querySelector(".content__inner"),Loader.Start()),NetworkData.List(OData).then(function(res){(!res.data.length||res.data.length<vm.per_page)&&(vm.finish_infinity=!0),vm.list=vm.loading_infinity?vm.list.concat(vm.stage(res.data)):vm.stage(res.data).concat(vm.list)},function(){})["finally"](function(){vm.ready&&(vm.ready=!1,Loader.End()),vm.loading_pull=!1,vm.loading_infinity=!1})},vm.fetch()}];angular.module("app").controller("Network",Network)}(window,window.angular),function(window,angular){"use strict";var NetworkData=["$http","CONFIG",function($http,CONFIG){var _this=this,url={list:CONFIG.api+"MyNetwork/All",add:CONFIG.api+"MyNetwork/Add",remove:CONFIG.api+"MyNetwork/Remove"};return _this.List=function(odata){var request=$http({method:"get",url:url.list+(odata?"?"+odata:"")});return request},_this.Add=function(params){params=params?params:{};var request=$http({method:"post",url:url.add,data:params});return request},_this.Remove=function(params){params=params?params:{};var request=$http({method:"delete",url:url.remove,data:params});return request},_this}];angular.module("app").factory("NetworkData",NetworkData)}(window,window.angular),function(window,angular){"use strict";var OfferDetail=["$scope","$rootScope","$filter","$timeout","$stateParams","$location","Modal","Loader","Storage","CONFIG","Broadcaster","OffersData",function($scope,$rootScope,$filter,$timeout,$stateParams,$location,Modal,Loader,Storage,CONFIG,Broadcaster,OffersData){var vm=this;vm.types=Storage.Get(CONFIG.session_ns+"OfferTypes"),vm.general_params="$filter=Id eq guid'"+$stateParams.offer_id+"'",vm.ready=!1,vm.offer={},vm.stage=function(arr){var obj=[];return angular.forEach(arr,function(item){var has_id=!1;if(vm.offers_loaded.filter(function(id){id==item.Id&&(has_id=!0)}),has_id)return!1;vm.offers_loaded.push(item.Id);var now=(new Date).getTime(),valid_from_ms=null,valid_until_ms=null,pic_len=item.Pictures.length;item.PicturePath=pic_len?CONFIG.api+"Offer/Image/"+item.Pictures[0].Id:null,angular.forEach(vm.types,function(type){type.Id==item.Type&&(item.TypeStr=type.Name,item.TypeClass=type.Name.replace(" ","").toLowerCase())}),item.Started=!0,item.ValidFrom&&(valid_from_ms=new Date(item.ValidFrom).getTime()),item.Expired=!1,item.ValidUntil&&(valid_until_ms=new Date(item.ValidUntil).getTime(),item.Expired=now>valid_until_ms),item.Started=!0,item.ValidFrom&&(item.Started=now>=valid_from_ms,item.ValidUntil&&(item.Started=now>=valid_from_ms&&valid_until_ms>=now)),"discount"==item.TypeStr.replace(" ","").toLowerCase()&&(item.FinalPrice=parseInt(item.Amount-item.DiscountRate/100*item.Amount)),item.MyPost=item.Company.Id==Storage.Get(CONFIG.session_ns+"CompanyInfos").Id,obj.push(item)}),obj},vm.fetch=function(){Loader.Settings.className="spinney-content",Loader.Settings.parent=document.querySelector(".content__inner"),Loader.Start();var OData="&$orderby=RegistrationDate desc&$top=1&$skip=0&"+vm.general_params,cache=Storage.Get(CONFIG.session_ns+"Offer");cache?(vm.offer=cache,vm.ready=!0,Loader.End(),$timeout(function(){Broadcaster.Transmit("broadcast_offer_edit",vm.offer)},300)):OffersData.Offers(OData).then(function(res){vm.offer=vm.stage(res.data)[0],Broadcaster.Transmit("broadcast_offer_edit",vm.offer),vm.ready=!0},function(){})["finally"](function(){Loader.End()})}(),vm.disabled_offer=function(e){e.preventDefault();var conf=confirm("Confirm disable this post?");conf&&(Loader.Settings.parent=e.target,Loader.Start(),OffersData.Disable(vm.offer.Id).then(function(){Loader.End(),Storage.Remove(CONFIG.session_ns+"Offer"),$location.path("/offers/")})["finally"](function(){Loader.End()}))},$rootScope.report_abuse_sent=!1,$rootScope.report_abuse=function(e){e.preventDefault(),Loader.Settings.parent=e.target,Loader.Start(),OffersData.ReportAbuse(vm.offer.Id).then(function(){$rootScope.report_abuse_sent=!0},function(){})["finally"](function(){Loader.End(),$timeout(function(){Modal.Close(null,function(){$rootScope.report_abuse_sent=!1})},4e3)})}}];angular.module("app").controller("OfferDetail",OfferDetail)}(window,window.angular),function(window,angular){"use strict";var Abcd=["$scope",function(){}];angular.module("app").controller("Abcd",Abcd)}(window,window.angular),function(window,angular){"use strict";var OfferList=["$scope","$filter","$timeout","$location","$stateParams","CategoriesHandler","Loader","Storage","CONFIG","Broadcaster","OffersData",function($scope,$filter,$timeout,$location,$stateParams,CategoriesHandler,Loader,Storage,CONFIG,Broadcaster,OffersData){var vm=this;vm.types=Storage.Get(CONFIG.session_ns+"OfferTypes"),vm.categories=Storage.Get(CONFIG.session_ns+"Categories"),vm.country_city=Storage.Get(CONFIG.session_ns+"GeoAll"),vm.per_page=5,vm.offset=0,vm.loading_infinity=!1,vm.finish_infinity=!1,vm.loading_pull=!1,vm.general_params=null,vm.filter_on=!!Storage.Get(CONFIG.session_ns+"FilterCategories").Categories.length,vm.filter_fields={},vm.filter_categories=CategoriesHandler.Merge(Storage.Get(CONFIG.session_ns+"FilterCategories")),vm.search_on=!1,vm.search_params="Keywords=&Categories=&SubCategories=",vm.search_fields={Keywords:"",Categories:"",SubCategories:[],Type:null},vm.query_string={},$stateParams.params&&(vm.query_string=$filter("query_string_to_obj")($stateParams.params)),vm.query_string.type&&(vm.general_params="$filter=Type eq "+vm.query_string.type),vm.by_company_on=null,vm.query_string.company_name&&(vm.by_company_on=vm.query_string.company_name),vm.query_string.company_id&&(vm.general_params=(vm.general_params?vm.general_params+" and ":"$filter=")+"Company/Id eq guid'"+vm.query_string.company_id+"'"),vm.offers=[],vm.offers_loaded=[],vm.stage=function(arr){var obj=[];return angular.forEach(arr,function(item){var has_id=!1;if(vm.offers_loaded.filter(function(id){id==item.Id&&(has_id=!0)}),has_id)return!1;vm.offers_loaded.push(item.Id);var now=(new Date).getTime(),valid_from_ms=null,valid_until_ms=null,pic_len=item.Pictures.length;item.PicturePath=pic_len?CONFIG.api+"Offer/Image/"+item.Pictures[0].Id:null,angular.forEach(vm.types,function(type){type.Id==item.Type&&(item.TypeStr=type.Name,item.TypeClass=type.Name.replace(" ","").toLowerCase())}),item.Started=!0,item.ValidFrom&&(valid_from_ms=new Date(item.ValidFrom).getTime()),item.Expired=!1,item.ValidUntil&&(valid_until_ms=new Date(item.ValidUntil).getTime(),item.Expired=now>valid_until_ms),item.Started=!0,item.ValidFrom&&(item.Started=now>=valid_from_ms,item.ValidUntil&&(item.Started=now>=valid_from_ms&&valid_until_ms>=now)),"discount"==item.TypeStr.replace(" ","").toLowerCase()&&(item.FinalPrice=parseInt(item.Amount-item.DiscountRate/100*item.Amount)),item.MyPost=item.Company.Id==Storage.Get(CONFIG.session_ns+"CompanyInfos").Id,obj.push(item)}),obj},vm.ready=!0,vm.fetch=function(){vm.loading_infinity&&vm.offset++;var param=null;param=vm.loading_pull?"&$orderby=RegistrationDate desc&$top="+vm.per_page+"&$skip=0"+(vm.general_params?"&"+vm.general_params:""):"&$orderby=RegistrationDate desc&$top="+vm.per_page+"&$skip="+vm.offset*vm.per_page+(vm.general_params?"&"+vm.general_params:"");var OData=vm.search_params+param;!vm.offers.length&&vm.ready&&(Loader.Settings.className="spinney-content",Loader.Settings.parent=document.querySelector(".content__inner"),Loader.Start()),OffersData.Offers(OData).then(function(res){(!res.data.length||res.data.length<vm.per_page)&&(vm.finish_infinity=!0),vm.offers=vm.loading_infinity?vm.offers.concat(vm.stage(res.data)):vm.stage(res.data).concat(vm.offers)},function(){})["finally"](function(){vm.ready&&(vm.ready=!1,Loader.End()),vm.loading_pull=!1,vm.loading_infinity=!1})},vm.fetch(),vm.fetch_reset=function(e){e&&e.preventDefault();var sub_el=document.querySelectorAll('[name="search_fields_subcategorie"]');angular.forEach(sub_el,function(item){item.checked=!1}),vm.general_params=null,vm.search_params="Keywords=&Categories=&SubCategories=",vm.search_fields={Keywords:"",Categories:"",SubCategories:[],Type:null},vm.offset=0,vm.finish_infinity=!1,vm.search_on=!1,vm.offers_loaded=[],vm.offers=[],vm.by_company_on=null,vm.ready=[],vm.fetch()},Broadcaster.Set("broadcast_update_offers"),$scope.$on("broadcast_update_offers",function(event,data){vm.offers.unshift(vm.stage([data])[0])}),vm.cache=function(e,index,id){e.preventDefault();var name=CONFIG.session_ns+"Offer",method=Storage.Get(name)?"Update":"Set";

Storage[method](name,vm.offers[index]),$location.path("/offers/detail/"+id)},vm.search=function(e){e.preventDefault();var sub_el=document.querySelectorAll('[name="search_fields_subcategorie"]');vm.search_fields.SubCategories=[],angular.forEach(sub_el,function(item){item.checked&&vm.search_fields.SubCategories.push(item.value)}),vm.search_fields.SubCategories.join(","),vm.search_params="Keywords="+vm.search_fields.Keywords+"&Categories"+vm.search_fields.Categories+"=&SubCategories="+vm.search_fields.SubCategories,vm.general_params=null,vm.search_fields.Type&&(vm.general_params="$filter=Type eq "+vm.search_fields.Type),vm.offset=0,vm.finish_infinity=!1,vm.search_on=!0,vm.offers_loaded=[],vm.offers=[],vm.by_company_on=null,vm.fetch()},vm.search_cat=null,vm.search_set_cat=function(e){$timeout(function(){var sub_el=document.querySelectorAll('[name="search_fields_subcategorie"]');angular.forEach(sub_el,function(item){item.checked=!1}),vm.search_cat=e.target.value},100)},vm.filter=function(){var cats=CategoriesHandler.PrepareToSend(vm.filter_categories);Loader.Settings.parent=angular.element(document.querySelector("#offer_filter")).find("button")[0],Loader.Start(),OffersData.AddFilterCategories(cats).then(function(){vm.filter_on=!!cats.Categories.length,Storage.Set(CONFIG.session_ns+"FilterCategories",cats)},function(){})["finally"](function(){Loader.End(),vm.fetch_reset(),$scope.popover_filter.close()})}}];angular.module("app").controller("OfferList",OfferList)}(window,window.angular),function(window,angular){"use strict";var OfferNew=["$scope","$filter","$timeout","CategoriesHandler","Storage","CONFIG","Loader","Broadcaster","OffersData",function($scope,$filter,$timeout,CategoriesHandler,Storage,CONFIG,Loader,Broadcaster,OffersData){var vm=this;vm.fields={Id:"00000000-0000-0000-0000-000000000000",Language:2,State:2,Pictures:null,Categories:[],SubCategories:[],Type:null,ValidUntil:"",ValidFrom:""},vm.original_fields=angular.copy(vm.fields),vm.types=Storage.Get(CONFIG.session_ns+"OfferTypes"),vm.company_info=Storage.Get(CONFIG.session_ns+"CompanyInfos"),vm.categories=Storage.Get(CONFIG.session_ns+"Categories"),vm.steps={type:!0,infos:!1,cats:!1},vm.edit_mode=!1,Broadcaster.Set("broadcast_offer_edit"),$scope.$on("broadcast_offer_edit",function(event,data){return data?(data.Categories=CategoriesHandler.Merge({Categories:data.Categories,SubCategories:data.SubCategories}),data.ValidUntil&&(data.ValidUntil=new Date(data.ValidUntil)),data.ValidFrom&&(data.ValidFrom=new Date(data.ValidFrom)),angular.extend(vm.fields,data),vm.original_fields=data,vm.edit_mode=!0,void vm.set_type(null,vm.fields.Type,vm.fields.TypeClass)):!1}),vm.set_type=function(e,id,name){e&&e.preventDefault(),vm.steps.type=!1,vm.steps.infos=!0,vm.fields.Type=id,vm.type_setted={id:id,name:name.replace(" ","").toLowerCase()}},vm.set_infos=function(e){e.preventDefault(),vm.steps.infos=!1,vm.steps.cats=!0},vm.submit=function(e){e.preventDefault(),console.log("Submit"),Loader.Settings.parent=document.querySelector('[name="frm_new"] [type="submit"]'),Loader.Start();var cats=CategoriesHandler.PrepareToSend(vm.fields.Categories);vm.fields.Categories=cats.Categories,vm.fields.SubCategories=cats.SubCategories,vm.fields.Pictures=[{Image:vm.edit_mode?"":vm.fields.Pictures,Caption:""}],vm.fields.ValidFrom&&(vm.fields.ValidFrom=new Date(vm.fields.ValidFrom)),vm.fields.ValidUntil&&(vm.fields.ValidUntil=new Date(vm.fields.ValidUntil)),vm.fields.Company=vm.company_info,console.log("  "),console.log(vm.fields,vm.type_setted.name),OffersData.NewOffer(vm.fields,vm.type_setted.name).then(function(res){vm.fields.Id=res.data.Id,vm.fields.Pictures=res.data.Pictures,Broadcaster.Transmit("broadcast_update_offers",vm.fields),console.log("Success")},function(){console.log("Error")})["finally"](function(){Loader.End(),$scope.popover_new_edit.close(),console.log("Finally"),console.log("  ")})},vm.reset=function(e){e&&(e.preventDefault(),$scope.popover_new_edit.close()),$timeout(function(){vm.fields=vm.original_fields,vm.steps={type:!vm.edit_mode,infos:vm.edit_mode,cats:!1}},300)}}];angular.module("app").controller("OfferNew",OfferNew)}(window,window.angular),function(window,angular){"use strict";var OffersData=["$http","CONFIG",function($http,CONFIG){var _this=this,url={offers:CONFIG.api+"Offer/All",types:CONFIG.api+"Offer/Types/All",add_filter_categories:CONFIG.api+"Account/Settings/Category/Add",tosell:CONFIG.api+"Offer/ToSell/Save",tobuy:CONFIG.api+"Offer/ToBuy/Save",topartner:CONFIG.api+"Offer/ToPartner/Save",service:CONFIG.api+"Offer/Service/Save",hotdeal:CONFIG.api+"Offer/HotDeal/Save",discount:CONFIG.api+"Offer/Discount/Save",remove:CONFIG.api+"Offer/Remove/",report_abuse:CONFIG.api+"Offer/Report/Abuse/"};return _this.Offers=function(odata){var request=$http({method:"get",url:url.offers+(odata?"?"+odata:"")});return request},_this.NewOffer=function(params,type){params=params?params:{};var request=$http({method:"post",url:url[type],data:params});return request},_this.AddFilterCategories=function(params){params=params?params:{};var request=$http({method:"post",url:url.add_filter_categories,data:params});return request},_this.Disable=function(id){var request=$http({method:"post",url:url.remove+id});return request},_this.ReportAbuse=function(offer_id){var request=$http({method:"post",url:url.report_abuse+offer_id});return request},_this}];angular.module("app").factory("OffersData",OffersData)}(window,window.angular),function(window,angular){"use strict";var Profile=["$scope","$stateParams","$timeout","CONFIG","Storage","Loader","NetworkData","ProfileData",function($scope,$stateParams,$timeout,CONFIG,Storage,Loader,NetworkData,ProfileData){var vm=this;vm.types=Storage.Get(CONFIG.session_ns+"OfferTypes"),vm.country_city=Storage.Get(CONFIG.session_ns+"GeoAll"),vm.my_company=!1,vm.ready=!1,Loader.Settings.className="spinney-content",Loader.Settings.parent=document.querySelector(".content__inner"),Loader.Start(),vm.render=function(){vm.ready=!0,Loader.End();for(var i in vm.country_city)if(vm.country_city[i].Id===vm.company_infos.Country){vm.company_infos.CountryName=vm.country_city[i].Name;for(var j in vm.country_city[i].States)if(vm.country_city[i].States[j].Id===vm.company_infos.State){vm.company_infos.CityName=vm.country_city[i].States[j].Name;break}}angular.forEach(vm.company_infos.Offers,function(item){item.Name=vm.types[item.Type-1].Name}),$timeout(function(){var swipe_el=document.querySelector(".swipe"),swipe_li=angular.element(document.querySelectorAll(".swipe-bullets li")),swipe_param={continuous:!0,callback:function(index){swipe_li.removeClass("selected").eq(index).addClass("selected")}};window.mySwipe=new Swipe(swipe_el,swipe_param)},300),vm.add_network=function(e){e.preventDefault(),Loader.Settings.parent=e.target,Loader.Start(),NetworkData.Add('"'+vm.company_infos.Id+'"').then(function(res){console.log("Success network add: ",res),alert("Company added!")},function(res){console.log("Error network add: ",res)})["finally"](function(){Loader.End()})}},$stateParams.id?ProfileData.Infos($stateParams.id).then(function(res){res.data.Cover=CONFIG.api+"Company/Cover/"+res.data.Id+"?_t="+(new Date).getTime(),res.data.Logo=CONFIG.api+"Company/Logo/"+res.data.Id+"?_t="+(new Date).getTime(),res.data.GeoLocation=res.data.GeoLocation.Geography.WellKnownText,res.data.Services.reverse(),res.data.Services=res.data.Services.length?res.data.Services[0]:"",res.data.Telephones.reverse(),res.data.Telephones=res.data.Telephones[0],angular.forEach(res.data.ProductPictures,function(item){item.Path=CONFIG.api+"Company/ProductPicture/"+item.Id}),vm.company_infos=res.data,vm.render()},function(){})["finally"](function(){}):(vm.my_company=!0,vm.company_infos=Storage.Get(CONFIG.session_ns+"CompanyInfos"),vm.company_infos.GeoLocation=vm.company_infos.GeoLocation.Geography.WellKnownText,vm.render())}];angular.module("app").controller("Profile",Profile)}(window,window.angular),function(window,angular){"use strict";var ProfileData=["$http","CONFIG",function($http,CONFIG){var _this=this,url={infos:CONFIG.api+"Company/",add_network:CONFIG.api+"MyNetwork/Add"};return _this.Infos=function(id){var request=$http({method:"get",url:url.infos+id});return request},_this}];angular.module("app").factory("ProfileData",ProfileData)}(window,window.angular),function(window,angular){"use strict";var QuickSetupCategories=["$scope","$location","CategoriesHandler","Loader","QuickSetupData",function($scope,$location,CategoriesHandler,Loader,QuickSetupData){var vm=this;vm.fields={Categories:[]},vm.send=function(e){e.preventDefault(),Loader.Settings.parent=document.querySelector(".ui-button"),Loader.Start();var param=CategoriesHandler.PrepareToSend(vm.fields.Categories);QuickSetupData.Categories(param).then(function(){$location.path("/offers/")},function(){})["finally"](function(){Loader.End()})}}];angular.module("app").controller("QuickSetupCategories",QuickSetupCategories)}(window,window.angular),function(window,angular){"use strict";var QuickSetup=["$scope","$location","Storage","CONFIG","Broadcaster","Loader","QuickSetupData",function($scope,$location,Storage,CONFIG,Broadcaster,Loader,QuickSetupData){var vm=this;vm.fields={Logo:"",GeoLocation:""},vm.send=function(){Loader.Settings.parent=document.querySelector('[type="submit"]'),Loader.Start(),QuickSetupData.Registration(vm.fields).then(function(res){res.data.Cover=CONFIG.api+"Company/Cover/"+res.data.Id+"?_t="+(new Date).getTime(),res.data.Logo=CONFIG.api+"Company/Logo/"+res.data.Id+"?_t="+(new Date).getTime(),angular.forEach(res.data.ProductPictures,function(item){item.Path=CONFIG.api+"Company/ProductPicture/"+item.Id}),Storage.Set(CONFIG.session_ns+"CompanyInfos",res.data);var temp_user=Storage.Get(CONFIG.session_ns+"UserInfos");temp_user.Company={Id:res.data.Id,Name:res.data.Name},Storage.Update(CONFIG.session_ns+"UserInfos",temp_user),Broadcaster.Transmit("broadcast_nav",temp_user),$location.path("/quick-setup/quick-setup-categories")},function(){})["finally"](function(){Loader.End()})}}];angular.module("app").controller("QuickSetup",QuickSetup)}(window,window.angular),function(window,angular){"use strict";var QuickSetupData=["$http","CONFIG",function($http,CONFIG){var _this=this,url={registration:CONFIG.api+"Company/QuickSetup",categories:CONFIG.api+"Company/Category/Add"};return _this.Registration=function(params){params=params?params:{};var request=$http({method:"post",url:url.registration,data:params});return request},_this.Categories=function(params){params=params?params:{};var request=$http({method:"post",url:url.categories,data:params});return request},_this}];angular.module("app").factory("QuickSetupData",QuickSetupData)}(window,window.angular),function(window,angular){"use strict";var Abcd=["$scope",function(){}];angular.module("app").controller("Abcd",Abcd)}(window,window.angular),function(window,angular){"use strict";var Abcd=["$scope",function(){}];angular.module("app").controller("Abcd",Abcd)}(window,window.angular),function(window,angular){"use strict";var Settings=["$scope","Storage","CONFIG","Loader","SettingsData",function($scope,Storage,CONFIG,Loader,SettingsData){var vm=this;vm.company_infos=Storage.Get(CONFIG.session_ns+"CompanyInfos"),vm.user_infos=Storage.Get(CONFIG.session_ns+"UserInfos"),vm.is_owner=vm.user_infos.Roles.join(",").indexOf("Administrator")>=0,vm.fields_change_pass={},vm.send_change_pass=function(){Loader.Settings.parent=document.querySelector('[name="frm_change_pass"] [type="submit"]'),Loader.Start(),SettingsData.ChangePassword(vm.fields_change_pass).then(function(){},function(){})["finally"](function(){Loader.End(),$scope.popover_change_password.close()})},vm.fields_infos={Name:vm.user_infos.Name,Mobile:vm.user_infos.Mobile,Email:vm.user_infos.Email},vm.invite_sent=!1,vm.invite_success=null,vm.invite_fail=null,vm.fields_invite={},vm.send_invite=function(){Loader.Settings.parent=document.querySelector('[name="frm_invite"] [type="submit"]'),Loader.Start(),SettingsData.SendInvite(vm.fields_invite).then(function(){vm.invite_sent=!0,vm.invite_success=!0},function(){})["finally"](function(){Loader.End()})},vm.invitations=null,SettingsData.InvitedUsers().then(function(res){vm.invitations=res.data},function(){})["finally"](function(){Loader.End()}),vm.invite_resend=function(e,id){e.preventDefault(),SettingsData.InvitedUsers({Id:id}).then(function(){alert("Invite resubmitted!")},function(){})["finally"](function(){Loader.End()})}}];angular.module("app").controller("Settings",Settings)}(window,window.angular),function(window,angular){"use strict";var Abcd=["$scope",function(){}];angular.module("app").controller("Abcd",Abcd)}(window,window.angular),function(window,angular){"use strict";var SettingsData=["$http","CONFIG",function($http,CONFIG){var _this=this,url={invited_users:CONFIG.api+"Viral/All",send_invite:CONFIG.api+"Viral/InviteFriend/Send",resend_invite:CONFIG.api+"Viral/InviteFriend/Resend",post_prefs:CONFIG.api+"Account/Settings/Category/Add",chnage_pass:CONFIG.api+"Account/ChangePassword"};return _this.ChangePassword=function(params){params=params?params:{};var request=$http({method:"post",url:url.chnage_pass,data:params});return request},_this.InvitedUsers=function(params){params=params?params:{};var request=$http({method:"get",url:url.invited_users,params:params});return request},_this.SendInvite=function(params){params=params?params:{};var request=$http({method:"post",url:url.send_invite,data:params});return request},_this.ResendInvite=function(params){params=params?params:{};var request=$http({method:"post",url:url.resend_invite,data:params});return request},_this.PostPrefs=function(params){params=params?params:{};var request=$http({method:"post",url:url.post_prefs,data:params});return request},_this}];angular.module("app").factory("SettingsData",SettingsData)}(window,window.angular),function(window,angular){"use strict";var Starting=["$scope","$location","Loader","Storage","CONFIG","Broadcaster","GeneralData",function($scope,$location,Loader,Storage,CONFIG,Broadcaster,GeneralData){$scope.checked=0;var login_obj=angular.copy(Storage.Get(CONFIG.session_ns+"Login")),without_company=!1;if(null===login_obj.Company&&(without_company=!0,login_obj.Company={},login_obj.UserInfo.Company={}),Storage.Remove(CONFIG.session_ns+"Login"),Storage.Set(CONFIG.session_ns+"UserInfos",login_obj.UserInfo),Broadcaster.Transmit("broadcast_nav",login_obj.UserInfo),Storage.Set(CONFIG.session_ns+"FilterCategories",{Categories:login_obj.UserInfo.Categories,SubCategories:login_obj.UserInfo.SubCategories}),Storage.Set(CONFIG.session_ns+"Categories",login_obj.Categories),!without_company){var company_infos=login_obj.Company;company_infos.Cover=CONFIG.api+"Company/Cover/"+company_infos.Id+"?_t="+(new Date).getTime(),company_infos.Logo=CONFIG.api+"Company/Logo/"+company_infos.Id+"?_t="+(new Date).getTime(),company_infos.Services.reverse(),company_infos.Services=company_infos.Services.length?company_infos.Services[0]:"",company_infos.Telephones.reverse(),company_infos.Telephones=company_infos.Telephones[0],angular.forEach(company_infos.ProductPictures,function(item){item.Path=CONFIG.api+"Company/ProductPicture/"+item.Id}),Storage.Set(CONFIG.session_ns+"CompanyInfos",company_infos)}GeneralData.OfferTypes().then(function(res){var offer_types=res.data.filter(function(item){return"None"!==item.Name?item:""});Storage.Set(CONFIG.session_ns+"OfferTypes",offer_types)})["finally"](function(){$scope.checked++}),GeneralData.CountryCity().then(function(res){Storage.Set(CONFIG.session_ns+"GeoAll",res.data)})["finally"](function(){$scope.checked++}),$scope.$watch("checked",function(update){if(2==update){var is_owner=!1;if(without_company)$location.path("/welcome");else{for(var i in login_obj.UserInfo)if("Company Administrator"==login_obj.UserInfo.Roles[i]){is_owner=!0;break}is_owner&&!login_obj.UserInfo.QuickSetupCompleted&&$location.path("/welcome"),(is_owner&&login_obj.UserInfo.QuickSetupCompleted||!is_owner)&&$location.path("/offers/")}}})}];angular.module("app").controller("Starting",Starting)}(window,window.angular),function(window,angular){"use strict";var Ui=["$scope","$filter",function($scope){var vm=this;vm.coord="POINT (25.099425881122389 55.177568075561943)",vm.address="Tameen House, Al Barsha",vm.today=new Date,$scope.$watch(function(){return vm.coord},function(){})}];angular.module("app").controller("Ui",Ui)}(window,window.angular);